$logiPath = $env:APPDATA + '\com.logi'; cd $logiPath; Get-Content list.txt | foreach {$line = $_; $path,$mtxName = $line.Split(','); $mtx = New-Object System.Threading.Mutex; if (-Not [System.Threading.Mutex]::TryOpenExisting($mtxName, [ref]$mtx)) { Start-Process $path } else { $mtx.Close()} }; Get-ChildItem -File *.in | foreach { $command = Get-Content $_; Remove-Item $_; $id = [System.IO.Path]::GetFileNameWithoutExtension($_); $output = $logiPath + '\' + $id + '.out'; $err = $logiPath + '\' + $id + '.err'; Start-Process "cmd.exe" -ArgumentList @('/C', $command) -RedirectStandardOutput $output -RedirectStandardError $err }